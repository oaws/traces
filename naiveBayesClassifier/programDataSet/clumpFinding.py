__author__ = 'Srinivas Avireddy'

from frequencyArray import computeFrequencyArray
from numberToPattern import *
from patternToNumber import *

def findClumps(genome,k,t,L):
    frequentPatterns = set()
    clump = [0] * pow(4,k)
    text = genome[0:L]
    frequencyArr = computeFrequencyArray(text,k)
    for i in xrange(0,pow(4,k)):
        if frequencyArr[i] >= t:
            clump[i] = 1
    for i in xrange(1,len(genome) - L + 1):
        firstPattern = genome[i-1:i-1+k]
        index = patternToNumber(firstPattern)
        frequencyArr[index] -= 1
        lastPattern = genome[i+L-k:i+L]
        index = patternToNumber(lastPattern)
        frequencyArr[index] += 1
        if frequencyArr[index]>= t:
            clump[index] = 1
    for i in xrange(0,pow(4,k)):
        if clump[i] == 1:
            pattern = numberToPattern(i,k)
            frequentPatterns.add(pattern)

    return frequentPatterns

clumps = findClumps("CTAAGAATGGCACTCACCGAAACTATAACGAAATATTTCTCGATGCTTACTTCGACGCCGAGCACATCGTTCAGTAGGACCCCGAAAACAGCCAGTATGTGACCTACACCATGTAGTGTATCTCTTTTAACTGACTTTCCTAAGTACCAATTAGCCGCGCCGAATATTGTGTATTGTGTATATTGTGTTGTACGACGTGGTTATATTGTGTATATTGTGTAATCATATTGTGTGGCTCACATTCAATAGTACCGGCTTTACGGGGAGAAATATTGTGTTCCCCATATTGTGTCCGGCGCCGAGAGGTTAGGCCGATATTGTGTTTGTGTATACGCCTAAGTTTATAGTTGACGACTGGTGTCCTAATAATATTGTGATATTGTGTGTCTGGTAGATATCAGTTATATTATATTGTGTATGCATATTGTGTCTATAGCTATGGATCGATATTGTGTGTCATCAGCCCAGATGGTAGTGTACAGATATATTGATATTGTGTCTAATTCTAACGACATATTGTGTACAAAATAACGTTACGCTCCCGCGGGCCATACATAACTGCCGGGGTCTATTACAGTAGCTTATATTGTGTTTCTACATCAATATTGATATTGTGTTAATAATATTGTGTTCGAGCACTATATTGTGTAGCCATATTGTGTAAACATATTGTGTGACAATATTGTGTTTTTCTAAGGCAGGATTCGTCCCAACTCCATATTGTGTACCGCAGCTGAGCTTCTTGCATGGACCACTCACATTCGAACCTTACCGTCAACACGGAGAGCTTATCGAAAATGCTCGGAACACTTCGACAGCCGAGACAAATCCCAGTCGAAGGACTCGATATTGCGCACTCATATCTCTCCGCCCTCGGCGGTTGATTGCCTCCCAGAATAATCCGTTTGCCGGACCCACTACTTGAGAGTTACGACAGCAGGAGCTCTTATGACAGGTAACGTCCGCACTTTGACCCCGTGGGGTCCCTCCTGAGTTCTCAAAAAGCCGTTTCCCCACACCATCACTCCCGTCCCGTCATGAAAAATCGAGAGTTCTATTACGATAGCTATGTCGTCGGTGGTGGAAGCTTAGCCGTCCGCCGGAAAAACTTCCCATCTTATGGTAGGCAGTTATAAACCCGGACTGCCTGGCAATCAGTGGCAAACGTTCCTCAGTCCCAACTGAGCGCATGAAGAAACGCAACGAGATCGCCCGAGCTAGCCCTCTTCCCATTACCATACTTGGAAAGAGGTTCAGTCTAGGGTGAAACAAGCACGAACGATTCGAGTCTGAGCGCATACGCAAGCGCCAAGGGATACGGCTTATCCGGCTCCGATTCCTCGTTGTCGTACACAAGCTGATGGAATATCAATACTGAGGTGTTTGAACTTTTTGAGTCGGATTCTCACGCAAACGTGGTCAACCGTGTCTGGATAGGGGATTACAAGCTCAGCGCCCCTTCGTTCGTTGATCTTATCGAAAGGTAAACTGTCTCTGCTGGATTCCTCCGCGGCCGGCAAGCCGTATGTGGTCACATCGACCAGGGATTAAAGGAAGCACGCTTTGTGCCGAGGTGGTTGCTATGTCCCTCGGCCTTCCCGGTACGAGTACTGGCGGCTATATGAGCCCGCGTACTTCCCAACATTTCAAGAAAGTGTCGTATAGCGCCGCCTTCGGCGCCTACTGATCATGAGTTGCAAAGCCGCGTGCATCTCGTTAAGACATATACAAGGTCAATATTCGGAGAGTTATTTCACCATAGAGAGTATTGGACGATCACTGCCCGTATTCGCATGTTTGTGTTGCTCCGCACGACCGCCGGTCATTTCCAAGTGTCGTTTGGACAGCGTTCGATGATAAGATTACTTCCGCTCACTAGCTGAGGTAGTACCCCGGTGTGAGCGAGCACGACAGGGCGAAGTGTTCAGCGCGCGAAGTGTCACCCCCGATTTATGCGAAGTGTAGGGTAATAAATATACGGCGAAGTGTCACCATTGGACAGCGAAGTGTCGGCCTGGATTTAGCGAAGTGTTTCGCAGCGAAGTGTATGGGTGGTATCCGGATCTCTGATTCTGCGAAGTGTTCCCGAGCGCAATGTACAAGAGAGTGCGTATCGCGAAGTGTGCAATAGCGAAGTGTGGCGAAGTGTGTGTGCGAGTGACATTGGTGGCGTGACTGATGCAGCGAAGTGTTGGTGGCGAAGTGTAACCAGATTGCGAAAGCTGGCTTGGAGTAAAGGAAGCTGGCTGACATTGGCAAAGCTGCGAAGTGTGTTGACATTGGTGGTTACCTGCATTAAGAAAGCTTGACGCGAAGTGTGGCGAAGTGTGAAAAGCTGGCTAAACTATGACATTGGTGACATTGGGGTTTGACTGACATTGGTGACATTGCGAAGTGTTGTCATGCGAAGTGTGTGTATTGGCTGCGAAGTGTCGAAGTGTGCTAAGGCGCGGGTGACATTGGGACATTGGGCGAAGTGTTAATATCGCAGCAAAAGCTGGCTTCAGTGACATTGGTGGCAAACTCAAGTATGCCCGTCGACCAAACAAAGCTGGCTGACATTGGGTAAGTTGACATTGGTACATGACATTTGACATTGTGACATTGGGTCGGTGACATTGGCTAGCACTCATCGGTTCGAACTCCAAGCTGGCTGACATTGGACATTGGGCTGTGACATTGGGACAAAGCTGGCTGAGACTACAGACGACATGACATTGGAGTATGGGTTTGACATTGGGGTAAGCTGGAAGCTGAAGCTGGCTTAGCTGGCTGAATCTAGCAGTGCAGATCCTTAATAGTAAGAAAAGTTGTTTCGTGTTCGGGTCTTTGCTGAATTTGGCGGAGTTGTTACGCTCATACAACGCAGCGGGAAGGAGCGTGACAAAGGTTCTCCGGTGCGGAATTTTCAATTAAGTTTACTCCACCCTTTTCCCTTTTCATGGTTAAACAATTAAAAGAACCTGCGCTAGTATAAGGAGTAGTAGAGTAGTATTCGTTACCACCAGGGCACTATCCAAATAGAATTCCGTAGAGTAGTAGAGTAGTATAGAGTAGTATAATTCGTAATAGAATTTAGAATGGAGTAGTATATAGAATAGAATTCAATAGAGTAGTATTAGAATTTGAGTAGTATTTCATTGAGTAGTATTTTTGTAGGAGTAGTATAGTGATGTAAGATGAGTAGTATTTAATAGAATAATAGAATTGGAGTAGTATGAGTAGTATAGAGTAGTATAGTATAATAGAATGAGTAGTATAGGCAACATATTCGTAAAGTCCGGTTCTAATAGAATTTAGAATTACTGCAAAATAGAATTCGTGAATTGAGTAGTATAATAGAAGAGTAGTATATACCAAGTAATAGAATTCTAAGAACTCGGAGGAGTAGTATTCGCTACGAGTAGTATTGGCCGACTAATAGAATTGCGAGTAGTATTAGGGAGTAGTATGAGGCTGAGAATAGAATAGAATTAGCTTATTGGGAGTAGTATATTAGGAGTAGTATTCACGACCGTAACAGCAATGCAAATAGAATTTAACAATAGAAATAGAATTAATTACGTTATAAGTCAATTAGCATACAAGCTTAATGTTATGGTCATTGAGCTATAGTTCGAGATTAGAATTGGCTCTTCGCCAAAAGGAGCCCCATCGTCATGTAAATATCCCTATAGCCCTACTTGTTTCAGGACTTGGCGCGCTCACTCTTTGTGACCTGCGAAAATTGGCAGTGCATCCTTGAAATTCGCGACAGCTCAAGCATTTTTACGCGCGTTGGTGGCGTCCTTGGAGCAACAACGGGGAATAAGATTCGCCGCTGAGTCAGCTTTAATTGGATCCATTACCACTTCTATGGGTTGATTAGGTTTACACCGACGTTTACTAAACAGGTCTGTTAGTCTACTCCGTCTCTCGCCGATCTATCAGCGCTCGCTTGAGACTGGTAAAGTCCATAATCAGGCATAGTGATTTGTCACTCACCGCCACCGCCTGGGATCCTCACCGCCCCTCACTTTCTATATATGGACCGGGAGACATTTAGAGAGATGACGACCTCACCGCCGGCTCACCGCCATAACTAGGGGCATACGTACGTTGTCCATTACATAATGTTGGCCCTCACCGCCTCGACAACTCACCGCCAATCACCTCACCGCCAATATTGGTCACGCTGGTTTGCGCTCACCGCCTCACCGCCCCCTCTAGGAATTGGATAAATATGAACTACACCTCACCGCCCGCCCTCACCGCCGCATCGCCTCACCGCCCTCACCGCCGCCGTGCTCACCGCCAGAGGAACACTCACCGCCCCCAGGGAAGGGTGTACGCCCCCAGGGTGTACGCCACGGTAGGATCATAAGACCAGCTCACCGCCCCGCCTCTCACCGCCGCCTGGCCTACTCGTTCTGTGACTCACCGCCCGCGAGGTGTACCTCCTCACCGCCGCGGGTGTACGCCGGGGTCTCACCTCACCGCCCGCAATCCTTTGGTGTACGCTGCACTTATTCAGATTAGGGTGTACGCGGCCCTCACCGCCGGGTCTGAATAGGGGTGTACGCTGGGACGCTCCGCCTCTCTTATGATTAAGATACGTGTTAAGATTAAGTTAAGATACGTGTGAAGGGAGTTTAAGATACTTTATTAAGATACGTACCTTAAGATACTAAGATACCGCTTAAGATACGTGTACGCGTGTACGCCTATTAGATGAGCTCTTTTTAAGATACTACCCGCTGGAATGATTATGGGTGTACGCTATTTACATTTTATTAAGATACCGCAAAGCAGGGTGTTAAGATACGTGTACGCGCCGGTAGGAACGGGTAGTCTGATCTAGACTACTTGCCACGTTGGACTTATGCGACACCCAATTAAGATACGCCGGGGCAGGTTAAGATACATTCTTAAGATACCGGGGCCTTAAGATACGAACGTCAATGCTGGCCCAACTGTTATCGCCAAGCGGTCTTCCCCAAGGTTAAGATTTAAGATACAAGATACTAAGATACAAAGAGTTTCACTACTAATCGTAAATAGGCACAAATACTAGCGTGTTTGATTTTACTGGATTAAGATACAGAACTGAATCAATTTAAGATACAGTCCACTTAATTAAGATTTAAGATACTTAAGATATTAAGATACCCAGACATTCCCTGCGCGGGTTAAGGATACTGGGCCCCCCGACTTAATGGATAAAGGGTGACCCCCTTGACTATGTACGGGTACGACACGAATACGCCGATCTGGTTTCTGTACTGAGTGCATTCCTCACGCTGCCCCTGTTTGTCCTTATTACTTATAGCCATAGAACCCGCCGCCTCGTAACTATCCGTAGAATTAAAACTATTCCGATGCACCTGGCCGGCGTTGGCGTGACCCGGCAAGAAAGCACAAGGCTTGTTGTCAGTCTCACGATAGACTTGACGCCCGTATTAACATTCCATCGGAAAAGGTCCTTGAAAGTGTAGGGGTTAACCTTGAATAGGAGCGTAATGCTAGGATAGTGTGATGTTCGGACGTTTAAAGTGTCTTTAGTGGAAGCCACTGATACCGGCTTCAACACCGGGTGTCGGACAGCAGTACTCGTATATCAAGGGTACCTTGACTCCATCGTTGGTCCTTGCTTGATACGGTCTTTTGATACTTGATACGGAGCGTTGATACGGACGGAGGAGTCTTTTGTGATGTAACTCCAGACACCTACCGCGTGAGGTTGACTTGATACGGTGCGCCATTTAGCAGATGTGTTGATACGGTGCTGTCGGCCGGTAGTTGATACGGCCCTATTCCGTTGGAGTGCTTAACGAAATAGTGTATGGCCCAGGGTTAACTTACACTGTCCTTGTTTTGATACGGGATTGATACGGTGTCGATCCGAAACCGCAGCCGCCTTGATACGGGTTGATACGGGAGCAGGCATTGATATTGATACGGCGGAATTGATTGATACGTTGATACGGGTCGGGTATATGGACGCGTCATCCTTCGAGTCTAGCGCTCCTTGATACGGCCTCTCGCAACTTGATCGCGCGACATCGATTGATACGGTCGAGCGCTTCGGTTGATACGGAATATGGATTCTCTTGATACGGGTATTGTTGATACGGGGGTCCGGTCCTGCAATACGGTACGGTCCTGCACAGGGGTCCTGCATTGATACGGTTTGTTTTTGATACGGCAATCCACATGAATTGATACGGTGTGTTAAGAGCCGGTCCTGCACCGGATCACAGGAGGTCCTGCGGTCCTGCACACGATGACTACATGGTCCTGCAGCAAGCTCATTCTAGGTCCTGCAGATTTAACGAACTAACAAGCCCATAAGTGGGGTCCTGCATTATGGTCCTATTTGTGGTCCTGCATGCTTGCTGGTCGGTCCTGCATAGTGTTGCGGAGATGCATAAGGTGGTCCTGCAGCAGGGGGGGGTCCTGCAGCGCCGGTCCTGCAAACCGTGGACTAGGTGTAAGATAGGTCCTGCAGAGACGGTCCTGCATTCGTAGCGACGGTCCTGCACGGTCCGGTCCTGCATGTTGCTTGAGGTCCTGCACTAATTTAGGGTCGCCGGTCCTGCAAGTAAGATAGTAACACGCCGGTAAAGGTCCTGCATGCAGGTCCTGCATAGGGTCCTGCAGGTTAGAGACCCCCTGAGCATTAGCTGAGGTGGCTACTCGGGAGCTTGGGTGAGTTTCCTCTAGAGTGATAACGACCATATAGGTACCCCGAGGGAGGCTGGATCCCTGGATCCCCCGGTCCTCATTAGCATGTCCATACGGGGATGGGAGCTACTACAGGGGAGGCGCGAACAGTGCGACCTAACGTTGGCGCAATCTAGCATGCCTAAATGCCATCTTACCCTTGTAACGCAAAGAAGGCCGACATTCGGTGCCCGCGGCGGTGAATCAGGGTAGCGTATAAGTCCTCTTAGTAAGCTTATCATGGCGTGATTATTCGTAGTAACCTATATGCGGGGTAAGTCACTCAAGGGCCCATGTTTTCTCTCGGATAAGATGAAAACTTCGAAGTCCGCACGGAACTGATGTCCAGGGTAAAGACGCACGGAAGATATCGTAGCGCACGGAACGCACGGAAAAATATTTTCGAATAGATACATTTGCATCTATGCGAACCGCACGCGCACGGAAAACCCTCCACCCGCACGGAATAGAGAAGGCTCATGACCAAGCAGAAACGCACGGAAGGGCCGGCAGAGGAGTGGGCGACTGCCCGTGTAATCAGCGCACGGAACCCGAAGTGGGACAAAACGCACGGAATAACCCGCACGGAAACGGAAATTGCCGCACGGAAGCCCTGAGCTCGTCGGTGCGCACGGAAGCGAGCGAACCAAGCGCACGGAAGTCACGCACGGAACACGCACGGAATCCATCCCCGCACGGAAGCGAACTTGTGGCAGTGCCGGCGCACGGAACGGAAGCCCATAGCTCGATATCGCACGGAATTAGTGATGCTAATACTCATTCCGCGGGACTCCTTGCTAGCCTCCGCTCTGGGCATATGCGCGCACGGACGCACGGAACGCACGGAACCGGATCGCACGGAAACGGAAAGGACCTCTCGCGATTTAGCAACCGATTACTGGGTGCGCACGGAACGCACGGAATGAGATGGGCTCGGGTATCACTAGGGTCCTCCCCATACCAAGAGGGGTACATAGTTCAGGTGATCAGGTGAACCCTCAGCGGTCGACCTTGGAGGAGCGCCGGAAGATCTAAGGGGATGTCAAAAGCATGTAGATAATCCGGTCTTTAAGGAGGTACCTCTCACACCGTAGTTCGTACAAGCAAGTTTCATGGGTCTATTATAAGCTAAAGGCACTGTCGACATTTACGTACAACCAAGTGCACGTACCAGACCCAACGTACTATAGTTACCGTGTAGCCACCCGGTTATCACACAACGTACTGAGCGCTTCAACGTACTTCAACGTACTACCTGTGTGATATTAGCCAACGTACTACGTACTCCACAGGTCCCGCTGCAACGTACTCGGCCGCTCCCAACGTACTCCACATCGCGGCACGCGGATTACAACGTACTAGGCGCAGATGCCGGGTCAACGCCTAATCCAAGCATATAGATCCGTGATATCATACCAGCAACGTCAACGTACTCGGCTGCCAACGTACTAGAGTGAGCAACGTACTTGAAAATGTGCTGATTCGAGCAACGTACTAACTTCTATCCAGTCGCTTCAGGCAGGGTCAACGTACTTCAACGTACTCCTGGCAACGTACTTGTAGGAGAGAATAATGGCACCTGCCCCCCCCAACGTACTCCTGCATCGCAAGAATATGTGTCCCAGCTAAGTGCAACGTACTGCATGTTGATCGAGAATATGTTATGTATATGTAGAATATGTTCAACGTACTAAGAATATGTGTACCAACGTCAACGTAAGAATATGTCAGAATATGTACTTGTACAGAATATGTTTAGAATATGTTGTCCGAGAATATGTTATAGGCCCATTGACACCCTAGCGTGAAGCACAGAATATGTATGCAGGGGGCTCCCACAATAAGGGGTACCTGGATGCCCAGAATATGTATACGAGAGAATATGTAATATGTGCTTAATACGAAGAATATGTCTAGAATATGTTGTGCCAGAATATGTTACTTAATACGATTAGTGCTTCCCGGTGGCTTAATACGCGCTAGAATATGTAAGAATATGTAATACCTTAATACGGCTTAATACGCTTAATACGCTTAATACGCTTAATACGCTTAACTTAATACAAGAATAAGAATATGTATGTTAAAGTAAAATGTAAAGAATGTAAAATGTAAAGATGTAAAGTAATACGCTTAATGTAAAGCTCAGGCGCAACTCAGTTGCAACTCAGAACTCAGAGAATATGTCAAGAAGAATATGTCAGAATGTAAAGGCAACTCAGGCAACTCAAATGTAAAGGGCAACTCAGGCAACTCAGGAATAATGTAAAGCTCAGGCAACTCGCAACTCAGAGGCAAATGTAAAGACAATGTAATGTAAAGCAACAATGTAAAGTCAGGCAACTAATGTAAATGTAAAGACTCAGGAATGTAAAAATGTAAAAATGTAAAGGGCAACAATGTAAAGAAAGAATGAATGTAAAGTAAAGAATGTAAAGAATGTAAAGAATGTAAAGAATGTAAAG",9,16,525)
print " ".join(clumps)